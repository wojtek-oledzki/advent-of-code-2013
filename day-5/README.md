Task 2 is super slow - brute force almost :(
It would be better to expand the transformation into a multiple single step transformations.
